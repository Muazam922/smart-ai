import { supabase } from '../supabaseClient.js';

export async function logExploit(exploitData) {
  const { data, error } = await supabase
    .from('exploit_logs')
    .insert([{
      contract_hash: exploitData.contractHash,
      vulnerability_type: exploitData.vulnType,
      exploit_code: exploitData.exploitCode,
      created_at: new Date().toISOString()
    }]);

  if (error) throw new Error('Exploit logging failed: ' + error.message);
  return data;
}

export async function getExploitsByContract(hash) {
  const { data, error } = await supabase
    .from('exploit_logs')
    .select('*')
    .eq('contract_hash', hash);

  if (error) throw new Error('Exploit retrieval failed: ' + error.message);
  return data;
}
